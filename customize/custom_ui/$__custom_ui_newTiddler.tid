created: 20180106174755084
creator: yuzijie
modified: 20230509155824539
modifier: yuzijie
tags: customized
title: $:/custom/ui/newTiddler
type: text/vnd.tiddlywiki

\define newTaskAction(template, caption)
<$action-sendmessage $message="tm-new-tiddler" $param="$template$" celltpl="customized-template-task" tags="Task" caption=<<__caption__>>/>
<$action-deletetiddler $tiddler="$:/temp/newTiddler"/>
\end

\define newCodeAction(template, caption)
<$action-sendmessage $message="tm-new-tiddler" $param="$template$" date=<<now 'YYYY0MM0DD'>> caption=<<__caption__>> language="" code-body="yes"/>
<$action-deletetiddler $tiddler="$:/temp/newTiddler"/>
\end

\define newExtFileActionCopy() <<l title:'$(title)$' mode:tr date:yes style:''>>

\define newExtFileAction(template, caption, type, path, note)
<$set name="title" value=<<unusedtitle "$template$">>><$set name="uri" filter="[[$path$]prefix[http]]" value="$path$" emptyValue="./files/$path$">
<$action-setfield $tiddler=<<title>> date=<<now YYYY0MM0DD>> belongs.to="Attachments" note="$note$" tags="Snippet" caption="$caption$" type="$type$" _canonical_uri=<<uri>>/>
<$action-sendmessage $message="tm-copy-to-clipboard" $param=<<newExtFileActionCopy>>/>
</$set></$set>
<$action-deletetiddler $tiddler="$:/temp/newTiddler"/>
\end

<$reveal type="match" state="$:/status/IsReadOnly" text="yes" tag="div">The Wiki is Read Only</$reveal>
<$reveal type="nomatch" state="$:/status/IsReadOnly" text="yes" tag="div">
<$list filter="[<tv-story-list>get[list]enlist-input[]prefix[Draft of]limit[1]]"><$button class="tc-btn-invisible">Save All
<$list filter="[<tv-story-list>get[list]enlist-input[]prefix[Draft of]]"><$action-sendmessage $message="tm-save-tiddler" $param=<<currentTiddler>>/></$list>
</$button></$list>
<p><$keyboard key="alt+enter" actions="<$macrocall $name=newTiddlerAction template={{$:/config/defaultTemplate}} caption={{$:/temp/newTiddler}} content={{$:/temp/newTiddler!!description}} scroll=no/>" tag="div">
<$edit-text tiddler="$:/temp/newTiddler" tag="input" size="30" class="new-tiddler-input-box" placeholder="Caption" default="" focus="yes"/>
<$set name="newValue" filter="[[$:/temp/newTiddler]get[text]] [<now YYYY-0MM-0DD>] +[join[ ]]" select="0">
<$button set="$:/temp/newTiddler" setTo=<<newValue>> tabindex="-1" class="tc-btn-invisible">üìÜ</$button>
</$set>
<$button message="tm-edit-tiddler" param="$:/custom/ui/newTiddler" class="tc-btn-invisible" tooltip="Edit Configurations" tabindex="-1">‚öôÔ∏è</$button><br>
<$edit-text tiddler="$:/temp/newTiddler" tag="input" size="30" class="new-tiddler-input-box" placeholder="Description/path/url/dir/attachment" field="description"/>
<$list filter="[[$:/temp/newTiddler]is[tiddler]]">
<$button class="tc-btn-invisible"><$macrocall $name=newTiddlerAction template={{$:/config/defaultTemplate}} caption={{$:/temp/newTiddler}} content={{$:/temp/newTiddler!!description}} scroll=no/>‚ûï</$button>
<$button class="tc-btn-invisible"><$action-deletetiddler $tiddler="$:/temp/newTiddler"/>‚ùå</$button>
</$list>
</$keyboard></p>
<$vars template={{$:/config/defaultTemplate}} caption={{$:/temp/newTiddler}} content={{$:/temp/newTiddler!!description}}>
<p>
<$button><$macrocall $name="newTiddlerAction" template=<<template>> caption=<<caption>> type="application/x-tiddler-dictionary" content=<<content>> text="Name: {{!!caption}}
Description: {{!!description}}" edit="yes"/>New Data</$button>
<$button><$macrocall $name="newTiddlerAction" template=<<template>> caption=<<caption>> content=<<content>> edit="yes"/>New Record</$button>
<$button><$macrocall $name="newTaskAction" template=<<template>> caption=<<caption>>/>New Task</$button>
</p>
<p style="margin-top:-10px;">
<$button><$macrocall $name="newTiddlerAction" template=<<template>> caption=<<caption>> field="path" content=<<content>> scroll="no" popup="close"/>New File</$button>
<$button><$macrocall $name="newTiddlerAction" template=<<template>> caption=<<caption>> field="url" content=<<content>> scroll="no" popup="close"/>New Link</$button>
<$button><$macrocall $name="newTiddlerAction" template=<<template>> caption=<<caption>> field="dir" content=<<content>> scroll="no" popup="close"/>New Dir</$button>
<$button><$macrocall $name="newCodeAction" template=<<template>> caption=<<caption>>/>New Code</$button>
</p>
<div style="font-variant:all-petite-caps;margin:-8px 0 -12px;">User defined</div><$transclude tiddler="$:/custom/ui/newTiddler/Templates" mode="block"/>
<div style="font-variant:all-petite-caps;margin:-8px 0 -12px;">Attachments</div>
<p>
<$button><$macrocall $name="newExtFileAction" template=<<template>> caption=<<caption>> path=<<content>> type="image/jpeg" note="JPG"/>New JPG</$button>
<$button><$macrocall $name="newExtFileAction" template=<<template>> caption=<<caption>> path=<<content>> type="image/png" note="PNG"/>New PNG</$button>
<$button><$macrocall $name="newExtFileAction" template=<<template>> caption=<<caption>> path=<<content>> type="image/gif" note="GIF"/>New GIF</$button>
<$button><$macrocall $name="newExtFileAction" template=<<template>> caption=<<caption>> path=<<content>> type="image/svg+xml" note="SVG"/>New SVG</$button>
</p>
<p style="margin-top:-10px;">
<$button><$macrocall $name="newExtFileAction" template=<<template>> caption=<<caption>> path=<<content>> type="text/html" note="HTML"/>New HTML</$button>
<$button><$macrocall $name="newExtFileAction" template=<<template>> caption=<<caption>> path=<<content>> type="application/pdf" note="PDF"/>New PDF</$button>
<$button><$macrocall $name="newExtFileAction" template=<<template>> caption=<<caption>> path=<<content>> type="audio/mp3" note="MP3"/>New MP3</$button>
</p>
</$vars><hr>
<p>{{$:/custom/ui/path-prefix}}</p>
<p style="margin-top:-10px;">
<$button message="tm-edit-tiddler" param="$:/config/defaultTemplate" class="tc-btn-invisible">Default Template: @@color:red;{{$:/config/defaultTemplate}}@@</$button>
</p>
</$reveal>